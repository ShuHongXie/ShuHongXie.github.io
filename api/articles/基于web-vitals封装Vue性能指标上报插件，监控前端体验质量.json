{"title":"åŸºäºweb-vitalså°è£…Vueæ€§èƒ½æŒ‡æ ‡ä¸ŠæŠ¥æ’ä»¶ï¼Œç›‘æ§å‰ç«¯ä½“éªŒè´¨é‡","uid":"f10979dfbc66a3866a0a2de1362673f9","slug":"åŸºäºweb-vitalså°è£…Vueæ€§èƒ½æŒ‡æ ‡ä¸ŠæŠ¥æ’ä»¶ï¼Œç›‘æ§å‰ç«¯ä½“éªŒè´¨é‡","date":"2025-03-10T16:00:00.000Z","updated":"2026-01-26T08:34:21.578Z","comments":true,"path":"api/articles/åŸºäºweb-vitalså°è£…Vueæ€§èƒ½æŒ‡æ ‡ä¸ŠæŠ¥æ’ä»¶ï¼Œç›‘æ§å‰ç«¯ä½“éªŒè´¨é‡.json","keywords":"è°¢å°è°¢çš„åšå®¢ï¼Œå‰ç«¯å¼€å‘ï¼ŒVueï¼ŒNode.js","cover":"https://blog-1300014307.cos.ap-guangzhou.myqcloud.com/blog/656e07437cfa7a029812907ebdef664a.jpeg","content":"<p>åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œæ€§èƒ½ä½“éªŒç›´æ¥å½±å“ç”¨æˆ·ç•™å­˜â€”â€”åŠ è½½æ…¢ã€äº¤äº’å¡é¡¿ã€å¸ƒå±€è·³åŠ¨ï¼Œéƒ½å¯èƒ½è®©ç”¨æˆ·ç¬é—´ç¦»å¼€ã€‚è€Œ <code>web-vitals</code> ä½œä¸º Google æ¨å‡ºçš„æ ¸å¿ƒ Web æ€§èƒ½æŒ‡æ ‡åº“ï¼Œèƒ½å¸®æˆ‘ä»¬ç²¾å‡†æ•è·å…³é”®æ€§èƒ½æ•°æ®ã€‚ä»Šå¤©å°±ç»“åˆ Vue3 å®æˆ˜ï¼Œæ•™å¤§å®¶å°è£…ä¸€ä¸ªå¯å¤ç”¨çš„æ€§èƒ½æŒ‡æ ‡ä¸ŠæŠ¥æ’ä»¶ï¼Œè¦†ç›– SPA è·¯ç”±åˆ‡æ¢åœºæ™¯ï¼Œå…¼é¡¾çµæ´»æ€§ä¸ç¨³å®šæ€§ã€‚</p>\n<h2 id=\"ä¸€ã€å…ˆææ‡‚ï¼šweb-vitals-çš„æ ¸å¿ƒæŒ‡æ ‡\"><a href=\"#ä¸€ã€å…ˆææ‡‚ï¼šweb-vitals-çš„æ ¸å¿ƒæŒ‡æ ‡\" class=\"headerlink\" title=\"ä¸€ã€å…ˆææ‡‚ï¼šweb-vitals çš„æ ¸å¿ƒæŒ‡æ ‡\"></a>ä¸€ã€å…ˆææ‡‚ï¼šweb-vitals çš„æ ¸å¿ƒæŒ‡æ ‡</h2><p>åœ¨åŠ¨æ‰‹å°è£…å‰ï¼Œå…ˆæ˜ç¡®æˆ‘ä»¬è¦é‡‡é›†çš„æ ¸å¿ƒæŒ‡æ ‡ï¼Œè¿™äº›æŒ‡æ ‡ç›´æ¥åæ˜ ç”¨æˆ·çœŸå®ä½“éªŒï¼š</p>\n<ul>\n<li><p><strong>CLSï¼ˆç´¯ç§¯å¸ƒå±€åç§»ï¼‰</strong>ï¼šè¡¡é‡é¡µé¢å¸ƒå±€ç¨³å®šæ€§ï¼Œå€¼è¶Šå°è¶Šä¼˜ï¼ˆå»ºè®® â‰¤0.1ï¼‰ï¼Œé¿å…å…ƒç´ çªç„¶è·³åŠ¨å½±å“é˜…è¯»ã€‚</p>\n</li>\n<li><p><strong>LCPï¼ˆæœ€å¤§å†…å®¹ç»˜åˆ¶ï¼‰</strong>ï¼šè¡¡é‡é¡µé¢åŠ è½½é€Ÿåº¦ï¼ŒæŒ‡è§†å£å†…æœ€å¤§å†…å®¹å…ƒç´ æ¸²æŸ“å®Œæˆçš„æ—¶é—´ï¼ˆå»ºè®® â‰¤2.5 ç§’ï¼‰ã€‚</p>\n</li>\n<li><p><strong>INPï¼ˆäº¤äº’åˆ°ä¸‹ä¸€æ¬¡ç»˜åˆ¶ï¼‰</strong>ï¼šè¡¡é‡äº¤äº’å“åº”é€Ÿåº¦ï¼Œæ›¿ä»£åŸ FID æŒ‡æ ‡ï¼Œåæ˜ ç”¨æˆ·ç‚¹å‡»ã€è§¦æ‘¸ç­‰æ“ä½œçš„åé¦ˆå»¶è¿Ÿï¼ˆå»ºè®® â‰¤200 æ¯«ç§’ï¼‰ã€‚</p>\n</li>\n<li><p><strong>FCPï¼ˆé¦–æ¬¡å†…å®¹ç»˜åˆ¶ï¼‰</strong>ï¼šè¡¡é‡é¡µé¢é¦–æ¬¡å‘ˆç°å†…å®¹çš„æ—¶é—´ï¼Œæ ‡å¿—ç€ç”¨æˆ·ä»åŠ è½½åˆ°çœ‹åˆ°å†…å®¹çš„èŠ‚ç‚¹ï¼ˆå»ºè®® â‰¤1.8 ç§’ï¼‰ã€‚</p>\n</li>\n<li><p><strong>TTFBï¼ˆé¦–å­—èŠ‚æ—¶é—´ï¼‰</strong>ï¼šè¡¡é‡ç½‘ç»œè¯·æ±‚å“åº”é€Ÿåº¦ï¼ŒæŒ‡æµè§ˆå™¨æ¥æ”¶ç¬¬ä¸€ä¸ªå­—èŠ‚æ•°æ®çš„æ—¶é—´ï¼ˆå»ºè®® â‰¤600 æ¯«ç§’ï¼‰ã€‚</p>\n</li>\n</ul>\n<p>è¿™äº›æŒ‡æ ‡ç”± <code>web-vitals</code> åº“æä¾›ç°æˆçš„é‡‡é›†æ–¹æ³•ï¼Œæˆ‘ä»¬åªéœ€åŸºäº Vue ç”Ÿæ€å°è£…é€‚é…é€»è¾‘ï¼Œå†åŠ ä¸Šä¸ŠæŠ¥èƒ½åŠ›å³å¯ã€‚</p>\n<h2 id=\"äºŒã€Vue3-æ’ä»¶å°è£…ï¼šä»é…ç½®åˆ°å®ç°\"><a href=\"#äºŒã€Vue3-æ’ä»¶å°è£…ï¼šä»é…ç½®åˆ°å®ç°\" class=\"headerlink\" title=\"äºŒã€Vue3 æ’ä»¶å°è£…ï¼šä»é…ç½®åˆ°å®ç°\"></a>äºŒã€Vue3 æ’ä»¶å°è£…ï¼šä»é…ç½®åˆ°å®ç°</h2><p>æˆ‘ä»¬å°†å°è£…ä¸€ä¸ª Vue æ’ä»¶ï¼Œæ”¯æŒè‡ªå®šä¹‰ä¸ŠæŠ¥åœ°å€ã€è·¯ç”±è”åŠ¨ã€å»é‡ä¸ŠæŠ¥ç­‰åŠŸèƒ½ï¼Œæ ¸å¿ƒé€»è¾‘åˆ†ä¸ºã€Œé…ç½®å®šä¹‰ â†’ å·¥å…·å‡½æ•° â†’ é‡‡é›†é€»è¾‘ â†’ æ’ä»¶æŒ‚è½½ã€å››éƒ¨åˆ†ã€‚</p>\n<h3 id=\"1-å®šä¹‰ç±»å‹æ¥å£ï¼šè§„èŒƒé…ç½®ä¸æ•°æ®ç»“æ„\"><a href=\"#1-å®šä¹‰ç±»å‹æ¥å£ï¼šè§„èŒƒé…ç½®ä¸æ•°æ®ç»“æ„\" class=\"headerlink\" title=\"1. å®šä¹‰ç±»å‹æ¥å£ï¼šè§„èŒƒé…ç½®ä¸æ•°æ®ç»“æ„\"></a>1. å®šä¹‰ç±»å‹æ¥å£ï¼šè§„èŒƒé…ç½®ä¸æ•°æ®ç»“æ„</h3><p>å…ˆé€šè¿‡ TypeScript å®šä¹‰é…ç½®é¡¹å’Œä¸ŠæŠ¥æ•°æ®ç»“æ„ï¼Œä¿è¯ç±»å‹å®‰å…¨ï¼ŒåŒæ—¶æ‰©å±•ä¸šåŠ¡æ‰€éœ€å­—æ®µï¼ˆå¦‚é¡¹ç›®åç§°ã€ç”¨æˆ· IDï¼‰ã€‚</p>\n<figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"keyword\">type</span> &#123; <span class=\"title class_\">App</span>, <span class=\"title class_\">Plugin</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&quot;vue&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"keyword\">type</span> &#123; <span class=\"title class_\">Router</span>, <span class=\"title class_\">RouteLocationNormalized</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&quot;vue-router&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123;</span><br><span class=\"line\">  onCLS,</span><br><span class=\"line\">  onLCP,</span><br><span class=\"line\">  onINP,</span><br><span class=\"line\">  onFCP,</span><br><span class=\"line\">  onTTFB,</span><br><span class=\"line\">  <span class=\"keyword\">type</span> <span class=\"title class_\">Metric</span>,</span><br><span class=\"line\">  <span class=\"keyword\">type</span> <span class=\"title class_\">ReportOpts</span>,</span><br><span class=\"line\">&#125; <span class=\"keyword\">from</span> <span class=\"string\">&quot;web-vitals&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * æ’ä»¶é…ç½®é¡¹ï¼ˆæ‰©å±•å®˜æ–¹èƒ½åŠ›ï¼Œé€‚é…Vueç”Ÿæ€ï¼‰</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">WebVitalsPluginOptions</span> &#123;</span><br><span class=\"line\">  reportUrl?: <span class=\"built_in\">string</span>; <span class=\"comment\">// ä¸ŠæŠ¥æ¥å£åœ°å€ï¼Œé»˜è®¤å€¼åç»­åˆå¹¶</span></span><br><span class=\"line\">  <span class=\"attr\">projectName</span>: <span class=\"built_in\">string</span>; <span class=\"comment\">// å¤šé¡¹ç›®åŒºåˆ†å¿…å¤‡</span></span><br><span class=\"line\">  <span class=\"attr\">buildVersion</span>: <span class=\"built_in\">string</span>; <span class=\"comment\">// ç‰ˆæœ¬è¿½æº¯</span></span><br><span class=\"line\">  router?: <span class=\"title class_\">Router</span>; <span class=\"comment\">// è·¯ç”±å®ä¾‹ï¼Œæ”¯æŒSPAåˆ‡æ¢é‡‡é›†</span></span><br><span class=\"line\">  delay?: <span class=\"built_in\">number</span>; <span class=\"comment\">// è·¯ç”±åˆ‡æ¢åå»¶è¿Ÿé‡‡é›†æ—¶é—´ï¼ˆmsï¼‰</span></span><br><span class=\"line\">  metrics?: (<span class=\"string\">&quot;CLS&quot;</span> | <span class=\"string\">&quot;LCP&quot;</span> | <span class=\"string\">&quot;INP&quot;</span> | <span class=\"string\">&quot;FCP&quot;</span> | <span class=\"string\">&quot;TTFB&quot;</span>)[]; <span class=\"comment\">// è‡ªå®šä¹‰é‡‡é›†æŒ‡æ ‡</span></span><br><span class=\"line\">  getUserId?: <span class=\"function\">() =&gt;</span> <span class=\"built_in\">string</span> | <span class=\"literal\">null</span> | <span class=\"literal\">undefined</span>; <span class=\"comment\">// å¯é€‰ï¼šè·å–å½“å‰ç”¨æˆ·ID</span></span><br><span class=\"line\">  customReporter?: <span class=\"function\">(<span class=\"params\">data: WebVitalsReportData</span>) =&gt;</span> <span class=\"built_in\">void</span>; <span class=\"comment\">// å¯é€‰ï¼šè‡ªå®šä¹‰ä¸ŠæŠ¥é€»è¾‘</span></span><br><span class=\"line\">  reportFinalOnly?: <span class=\"built_in\">boolean</span>; <span class=\"comment\">// æ˜¯å¦ä»…ä¸ŠæŠ¥æœ€ç»ˆå€¼ï¼Œé¿å…é‡å¤</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * ä¸ŠæŠ¥æ•°æ®ç»“æ„ï¼ˆèåˆå®˜æ–¹æŒ‡æ ‡+ä¸šåŠ¡å­—æ®µï¼‰</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">WebVitalsReportData</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">// å®˜æ–¹Metricæ ¸å¿ƒå­—æ®µï¼ˆä¸¥æ ¼å¯¹é½ï¼Œä¾¿äºåç»­åˆ†æï¼‰</span></span><br><span class=\"line\">  <span class=\"attr\">name</span>: <span class=\"title class_\">Metric</span>[<span class=\"string\">&quot;name&quot;</span>];</span><br><span class=\"line\">  <span class=\"attr\">value</span>: <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  <span class=\"attr\">delta</span>: <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  <span class=\"attr\">id</span>: <span class=\"title class_\">Metric</span>[<span class=\"string\">&quot;id&quot;</span>];</span><br><span class=\"line\">  <span class=\"attr\">startTime</span>: <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  label?: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  attribution?: <span class=\"built_in\">any</span>; <span class=\"comment\">// å½’å› æ•°æ®ï¼ˆéœ€ä½¿ç”¨attributionç‰ˆæœ¬çš„web-vitalsï¼‰</span></span><br><span class=\"line\">  <span class=\"comment\">// ä¸šåŠ¡æ‰©å±•å­—æ®µ</span></span><br><span class=\"line\">  <span class=\"attr\">kind</span>: <span class=\"string\">&quot;performance&quot;</span>;</span><br><span class=\"line\">  <span class=\"attr\">type</span>: <span class=\"string\">&quot;web-vitals&quot;</span>;</span><br><span class=\"line\">  <span class=\"attr\">pagePath</span>: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  <span class=\"attr\">pageName</span>: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  <span class=\"attr\">projectName</span>: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  <span class=\"attr\">buildVersion</span>: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  <span class=\"attr\">userId</span>: <span class=\"built_in\">string</span> | <span class=\"literal\">null</span>;</span><br><span class=\"line\">  <span class=\"attr\">deviceUuid</span>: <span class=\"built_in\">string</span>; <span class=\"comment\">// è®¾å¤‡å”¯ä¸€æ ‡è¯†</span></span><br><span class=\"line\">  <span class=\"attr\">reportTime</span>: <span class=\"built_in\">number</span>; <span class=\"comment\">// ä¸ŠæŠ¥æ—¶é—´æˆ³</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-å·¥å…·å‡½æ•°ï¼šè§£å†³è®¾å¤‡æ ‡è¯†ã€å»é‡ä¸æ•°æ®æ„é€ \"><a href=\"#2-å·¥å…·å‡½æ•°ï¼šè§£å†³è®¾å¤‡æ ‡è¯†ã€å»é‡ä¸æ•°æ®æ„é€ \" class=\"headerlink\" title=\"2. å·¥å…·å‡½æ•°ï¼šè§£å†³è®¾å¤‡æ ‡è¯†ã€å»é‡ä¸æ•°æ®æ„é€ \"></a>2. å·¥å…·å‡½æ•°ï¼šè§£å†³è®¾å¤‡æ ‡è¯†ã€å»é‡ä¸æ•°æ®æ„é€ </h3><p>è¿™éƒ¨åˆ†æ˜¯æ’ä»¶çš„åŸºç¡€èƒ½åŠ›ï¼Œè´Ÿè´£ç”Ÿæˆè®¾å¤‡å”¯ä¸€æ ‡è¯†ã€é¿å…é‡å¤ä¸ŠæŠ¥ã€æ„é€ æ ‡å‡†åŒ–ä¸ŠæŠ¥æ•°æ®ï¼Œç¡®ä¿é‡‡é›†çš„å‡†ç¡®æ€§ã€‚</p>\n<h4 id=\"ï¼ˆ1ï¼‰è®¾å¤‡å”¯ä¸€æ ‡è¯†ï¼šæŒä¹…åŒ–å­˜å‚¨\"><a href=\"#ï¼ˆ1ï¼‰è®¾å¤‡å”¯ä¸€æ ‡è¯†ï¼šæŒä¹…åŒ–å­˜å‚¨\" class=\"headerlink\" title=\"ï¼ˆ1ï¼‰è®¾å¤‡å”¯ä¸€æ ‡è¯†ï¼šæŒä¹…åŒ–å­˜å‚¨\"></a>ï¼ˆ1ï¼‰è®¾å¤‡å”¯ä¸€æ ‡è¯†ï¼šæŒä¹…åŒ–å­˜å‚¨</h4><p>ç”Ÿæˆè®¾å¤‡ UUID å¹¶å­˜åœ¨ localStorage ä¸­ï¼Œç”¨äºåŒºåˆ†ä¸åŒè®¾å¤‡çš„æ€§èƒ½æ•°æ®ï¼Œå³ä½¿é¡µé¢åˆ·æ–°ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚</p>\n<figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * ç”Ÿæˆè®¾å¤‡å”¯ä¸€æ ‡è¯†ï¼ˆæŒä¹…åŒ–åˆ°localStorageï¼‰</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> getDeviceUuid = (): <span class=\"function\"><span class=\"params\">string</span> =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"variable constant_\">KEY</span> = <span class=\"string\">&quot;web_vitals_device_uuid&quot;</span>;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> uuid = <span class=\"variable language_\">localStorage</span>.<span class=\"title function_\">getItem</span>(<span class=\"variable constant_\">KEY</span>);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!uuid) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ä¼˜å…ˆä½¿ç”¨æµè§ˆå™¨åŸç”ŸAPIï¼Œå…¼å®¹ä½ç‰ˆæœ¬ç”¨æ—¶é—´æˆ³+éšæœºæ•°</span></span><br><span class=\"line\">    uuid = crypto.<span class=\"property\">randomUUID</span></span><br><span class=\"line\">      ? crypto.<span class=\"title function_\">randomUUID</span>()</span><br><span class=\"line\">      : <span class=\"string\">`<span class=\"subst\">$&#123;<span class=\"built_in\">Date</span>.now()&#125;</span>-<span class=\"subst\">$&#123;<span class=\"built_in\">Math</span>.random().toString(<span class=\"number\">36</span>).slice(<span class=\"number\">2</span>, <span class=\"number\">10</span>)&#125;</span>`</span>;</span><br><span class=\"line\">    <span class=\"variable language_\">localStorage</span>.<span class=\"title function_\">setItem</span>(<span class=\"variable constant_\">KEY</span>, uuid);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> uuid;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ï¼ˆ2ï¼‰å»é‡ç¼“å­˜ï¼šé¿å…åŒä¸€æŒ‡æ ‡é‡å¤ä¸ŠæŠ¥\"><a href=\"#ï¼ˆ2ï¼‰å»é‡ç¼“å­˜ï¼šé¿å…åŒä¸€æŒ‡æ ‡é‡å¤ä¸ŠæŠ¥\" class=\"headerlink\" title=\"ï¼ˆ2ï¼‰å»é‡ç¼“å­˜ï¼šé¿å…åŒä¸€æŒ‡æ ‡é‡å¤ä¸ŠæŠ¥\"></a>ï¼ˆ2ï¼‰å»é‡ç¼“å­˜ï¼šé¿å…åŒä¸€æŒ‡æ ‡é‡å¤ä¸ŠæŠ¥</h4><p>SPA è·¯ç”±åˆ‡æ¢åï¼ŒåŒä¸€æŒ‡æ ‡å¯èƒ½è¢«é‡å¤è§¦å‘ï¼Œç”¨ Map å­˜å‚¨â€œæŒ‡æ ‡ ID-é¡µé¢è·¯å¾„â€ï¼Œç¡®ä¿åŒä¸€é¡µé¢çš„åŒä¸€æŒ‡æ ‡ä»…ä¸ŠæŠ¥ä¸€æ¬¡ã€‚</p>\n<figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å»é‡ç¼“å­˜ï¼škeyä¸ºæŒ‡æ ‡IDï¼Œvalueä¸ºé¡µé¢è·¯å¾„</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> reportedMetrics = <span class=\"keyword\">new</span> <span class=\"title class_\">Map</span>&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">number</span>&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * è·¯ç”±åˆ‡æ¢æ—¶é‡ç½®ç¼“å­˜ï¼Œå…è®¸å½“å‰é¡µé¢é‡æ–°é‡‡é›†</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">resetReportedMetrics</span> = (<span class=\"params\">pagePath: <span class=\"built_in\">string</span></span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">keysToDelete</span>: <span class=\"built_in\">string</span>[] = [];</span><br><span class=\"line\">  reportedMetrics.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">_, key</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (key.<span class=\"title function_\">includes</span>(<span class=\"string\">`-<span class=\"subst\">$&#123;pagePath&#125;</span>-`</span>)) keysToDelete.<span class=\"title function_\">push</span>(key);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">  keysToDelete.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">key</span>) =&gt;</span> reportedMetrics.<span class=\"title function_\">delete</span>(key));</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(</span><br><span class=\"line\">    <span class=\"string\">`ğŸ§¹ æ¸…é™¤é¡µé¢ <span class=\"subst\">$&#123;pagePath&#125;</span> çš„æŒ‡æ ‡ç¼“å­˜ï¼Œå…± <span class=\"subst\">$&#123;keysToDelete.length&#125;</span> æ¡`</span></span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ï¼ˆ3ï¼‰æ•°æ®æ„é€ ï¼šèåˆå®˜æ–¹ä¸ä¸šåŠ¡å­—æ®µ\"><a href=\"#ï¼ˆ3ï¼‰æ•°æ®æ„é€ ï¼šèåˆå®˜æ–¹ä¸ä¸šåŠ¡å­—æ®µ\" class=\"headerlink\" title=\"ï¼ˆ3ï¼‰æ•°æ®æ„é€ ï¼šèåˆå®˜æ–¹ä¸ä¸šåŠ¡å­—æ®µ\"></a>ï¼ˆ3ï¼‰æ•°æ®æ„é€ ï¼šèåˆå®˜æ–¹ä¸ä¸šåŠ¡å­—æ®µ</h4><p>å°† <code>web-vitals</code> è¿”å›çš„åŸå§‹æŒ‡æ ‡ï¼Œä¸é¡¹ç›®åç§°ã€é¡µé¢è·¯å¾„ç­‰ä¸šåŠ¡å­—æ®µåˆå¹¶ï¼Œç”Ÿæˆæ ‡å‡†åŒ–ä¸ŠæŠ¥æ•°æ®ã€‚</p>\n<figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * æ„é€ ä¸ŠæŠ¥æ•°æ®ï¼ˆä¸¥æ ¼å¯¹é½ç»“æ„ï¼Œä¾¿äºåç«¯è§£æï¼‰</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> buildReportData = (</span><br><span class=\"line\">  <span class=\"attr\">metric</span>: <span class=\"title class_\">Metric</span>,</span><br><span class=\"line\">  <span class=\"attr\">pagePath</span>: <span class=\"built_in\">string</span>,</span><br><span class=\"line\">  <span class=\"attr\">pageName</span>: <span class=\"built_in\">string</span>,</span><br><span class=\"line\">  <span class=\"attr\">options</span>: <span class=\"title class_\">WebVitalsPluginOptions</span></span><br><span class=\"line\">): <span class=\"function\"><span class=\"params\">WebVitalsReportData</span> =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// å®˜æ–¹æ ¸å¿ƒå­—æ®µ</span></span><br><span class=\"line\">    <span class=\"attr\">name</span>: metric.<span class=\"property\">name</span>,</span><br><span class=\"line\">    <span class=\"attr\">value</span>: metric.<span class=\"property\">value</span>,</span><br><span class=\"line\">    <span class=\"attr\">delta</span>: metric.<span class=\"property\">delta</span>,</span><br><span class=\"line\">    <span class=\"attr\">id</span>: metric.<span class=\"property\">id</span>,</span><br><span class=\"line\">    <span class=\"attr\">startTime</span>: (metric <span class=\"keyword\">as</span> <span class=\"built_in\">any</span>).<span class=\"property\">startTime</span>,</span><br><span class=\"line\">    <span class=\"attr\">label</span>: (metric <span class=\"keyword\">as</span> <span class=\"built_in\">any</span>).<span class=\"property\">label</span>,</span><br><span class=\"line\">    <span class=\"attr\">attribution</span>:</span><br><span class=\"line\">      <span class=\"string\">&quot;attribution&quot;</span> <span class=\"keyword\">in</span> metric ? (metric <span class=\"keyword\">as</span> <span class=\"built_in\">any</span>).<span class=\"property\">attribution</span> : <span class=\"literal\">undefined</span>,</span><br><span class=\"line\">    <span class=\"comment\">// ä¸šåŠ¡å­—æ®µ</span></span><br><span class=\"line\">    <span class=\"attr\">kind</span>: <span class=\"string\">&quot;performance&quot;</span>,</span><br><span class=\"line\">    <span class=\"attr\">type</span>: <span class=\"string\">&quot;web-vitals&quot;</span>,</span><br><span class=\"line\">    pagePath,</span><br><span class=\"line\">    pageName,</span><br><span class=\"line\">    <span class=\"attr\">projectName</span>: options.<span class=\"property\">projectName</span>,</span><br><span class=\"line\">    <span class=\"attr\">buildVersion</span>: options.<span class=\"property\">buildVersion</span>,</span><br><span class=\"line\">    <span class=\"attr\">userId</span>: options.<span class=\"property\">getUserId</span>?.() || <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"attr\">deviceUuid</span>: <span class=\"title function_\">getDeviceUuid</span>(),</span><br><span class=\"line\">    <span class=\"attr\">reportTime</span>: <span class=\"title class_\">Date</span>.<span class=\"title function_\">now</span>(),</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-æ ¸å¿ƒé‡‡é›†é€»è¾‘ï¼šå¯¹æ¥-web-vitals-API\"><a href=\"#3-æ ¸å¿ƒé‡‡é›†é€»è¾‘ï¼šå¯¹æ¥-web-vitals-API\" class=\"headerlink\" title=\"3. æ ¸å¿ƒé‡‡é›†é€»è¾‘ï¼šå¯¹æ¥ web-vitals API\"></a>3. æ ¸å¿ƒé‡‡é›†é€»è¾‘ï¼šå¯¹æ¥ web-vitals API</h3><p>é€šè¿‡<code>web-vitals</code> æä¾›çš„ç›‘å¬æ–¹æ³•ï¼ŒæŒ‰éœ€é‡‡é›†æŒ‡æ ‡ï¼Œç»“åˆé…ç½®é¡¹æ§åˆ¶æ˜¯å¦ä¸ŠæŠ¥æœ€ç»ˆå€¼ã€æ˜¯å¦æ•è·å†å²æŒ‡æ ‡ã€‚</p>\n<figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * æ ¸å¿ƒä¸ŠæŠ¥é€»è¾‘ï¼ˆå«å»é‡ã€é”™è¯¯æ•è·ï¼Œä¸å½±å“ä¸»æµç¨‹ï¼‰</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> reportMetric = (</span><br><span class=\"line\">  <span class=\"attr\">metric</span>: <span class=\"title class_\">Metric</span>,</span><br><span class=\"line\">  <span class=\"attr\">pagePath</span>: <span class=\"built_in\">string</span>,</span><br><span class=\"line\">  <span class=\"attr\">pageName</span>: <span class=\"built_in\">string</span>,</span><br><span class=\"line\">  <span class=\"attr\">options</span>: <span class=\"title class_\">WebVitalsPluginOptions</span></span><br><span class=\"line\">): <span class=\"function\"><span class=\"params\">void</span> =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">// å»é‡æ ¡éªŒï¼šåŒä¸€é¡µé¢åŒä¸€æŒ‡æ ‡IDä»…ä¸ŠæŠ¥ä¸€æ¬¡</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> cachedPath = reportedMetrics.<span class=\"title function_\">get</span>(metric.<span class=\"property\">id</span>);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (cachedPath === pagePath) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  reportedMetrics.<span class=\"title function_\">set</span>(metric.<span class=\"property\">id</span>, pagePath);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// æ„å»ºæ•°æ®ï¼Œä¼˜å…ˆä½¿ç”¨è‡ªå®šä¹‰ä¸ŠæŠ¥å‡½æ•°ï¼Œå¦åˆ™ç”¨é»˜è®¤å‡½æ•°</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> reportData = <span class=\"title function_\">buildReportData</span>(metric, pagePath, pageName, options);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> reporter =</span><br><span class=\"line\">    options.<span class=\"property\">customReporter</span> ||</span><br><span class=\"line\">    (<span class=\"function\">(<span class=\"params\">data</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">// å‡è®¾sendDataæ˜¯é€šç”¨æ¥å£è¯·æ±‚å‡½æ•°</span></span><br><span class=\"line\">      <span class=\"title function_\">sendData</span>(data, options.<span class=\"property\">reportUrl</span> || <span class=\"string\">&quot;/api/v1/monitor/web-vitals&quot;</span>);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// æ•è·ä¸ŠæŠ¥é”™è¯¯ï¼Œé¿å…é˜»å¡é¡µé¢é€»è¾‘</span></span><br><span class=\"line\">  <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">reporter</span>(reportData);</span><br><span class=\"line\">  &#125; <span class=\"keyword\">catch</span> (err) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">warn</span>(<span class=\"string\">`Web Vitals ä¸ŠæŠ¥å¤±è´¥ [<span class=\"subst\">$&#123;metric.name&#125;</span>]:`</span>, err);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * åˆå§‹åŒ–æŒ‡æ ‡é‡‡é›†ï¼ˆæ”¯æŒè·¯ç”±åˆ‡æ¢åé‡æ–°è°ƒç”¨ï¼‰</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> initVitalsCollection = (<span class=\"attr\">options</span>: <span class=\"title class_\">WebVitalsPluginOptions</span>): <span class=\"function\"><span class=\"params\">void</span> =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> &#123;</span><br><span class=\"line\">    metrics = [<span class=\"string\">&quot;CLS&quot;</span>, <span class=\"string\">&quot;LCP&quot;</span>, <span class=\"string\">&quot;INP&quot;</span>, <span class=\"string\">&quot;FCP&quot;</span>, <span class=\"string\">&quot;TTFB&quot;</span>],</span><br><span class=\"line\">    reportFinalOnly = <span class=\"literal\">true</span>,</span><br><span class=\"line\">  &#125; = options;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// åŸºç¡€é…ç½®ï¼šbuffered=trueæ•è·å†å²æŒ‡æ ‡ï¼ŒreportAllChangesæ§åˆ¶æ˜¯å¦ä¸ŠæŠ¥æ‰€æœ‰å˜åŒ–</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">baseOpts</span>: <span class=\"title class_\">ReportOpts</span> &amp; &#123; buffered?: <span class=\"built_in\">boolean</span> &#125; = &#123;</span><br><span class=\"line\">    <span class=\"attr\">buffered</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"attr\">reportAllChanges</span>: !reportFinalOnly,</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// æŒ‰éœ€æ³¨å†ŒæŒ‡æ ‡ç›‘å¬</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (metrics.<span class=\"title function_\">includes</span>(<span class=\"string\">&quot;CLS&quot;</span>))</span><br><span class=\"line\">    <span class=\"title function_\">onCLS</span>(</span><br><span class=\"line\">      <span class=\"function\">(<span class=\"params\">metric</span>) =&gt;</span></span><br><span class=\"line\">        <span class=\"title function_\">reportMetric</span>(metric, currentPage.<span class=\"property\">path</span>, currentPage.<span class=\"property\">name</span>, options),</span><br><span class=\"line\">      baseOpts</span><br><span class=\"line\">    );</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (metrics.<span class=\"title function_\">includes</span>(<span class=\"string\">&quot;LCP&quot;</span>))</span><br><span class=\"line\">    <span class=\"title function_\">onLCP</span>(</span><br><span class=\"line\">      <span class=\"function\">(<span class=\"params\">metric</span>) =&gt;</span></span><br><span class=\"line\">        <span class=\"title function_\">reportMetric</span>(metric, currentPage.<span class=\"property\">path</span>, currentPage.<span class=\"property\">name</span>, options),</span><br><span class=\"line\">      baseOpts</span><br><span class=\"line\">    );</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (metrics.<span class=\"title function_\">includes</span>(<span class=\"string\">&quot;INP&quot;</span>))</span><br><span class=\"line\">    <span class=\"title function_\">onINP</span>(</span><br><span class=\"line\">      <span class=\"function\">(<span class=\"params\">metric</span>) =&gt;</span></span><br><span class=\"line\">        <span class=\"title function_\">reportMetric</span>(metric, currentPage.<span class=\"property\">path</span>, currentPage.<span class=\"property\">name</span>, options),</span><br><span class=\"line\">      baseOpts</span><br><span class=\"line\">    );</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (metrics.<span class=\"title function_\">includes</span>(<span class=\"string\">&quot;FCP&quot;</span>))</span><br><span class=\"line\">    <span class=\"title function_\">onFCP</span>(</span><br><span class=\"line\">      <span class=\"function\">(<span class=\"params\">metric</span>) =&gt;</span></span><br><span class=\"line\">        <span class=\"title function_\">reportMetric</span>(metric, currentPage.<span class=\"property\">path</span>, currentPage.<span class=\"property\">name</span>, options),</span><br><span class=\"line\">      baseOpts</span><br><span class=\"line\">    );</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (metrics.<span class=\"title function_\">includes</span>(<span class=\"string\">&quot;TTFB&quot;</span>))</span><br><span class=\"line\">    <span class=\"title function_\">onTTFB</span>(</span><br><span class=\"line\">      <span class=\"function\">(<span class=\"params\">metric</span>) =&gt;</span></span><br><span class=\"line\">        <span class=\"title function_\">reportMetric</span>(metric, currentPage.<span class=\"property\">path</span>, currentPage.<span class=\"property\">name</span>, options),</span><br><span class=\"line\">      baseOpts</span><br><span class=\"line\">    );</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-æ’ä»¶å°è£…ï¼šé€‚é…-Vue3-ç”Ÿæ€ä¸è·¯ç”±\"><a href=\"#4-æ’ä»¶å°è£…ï¼šé€‚é…-Vue3-ç”Ÿæ€ä¸è·¯ç”±\" class=\"headerlink\" title=\"4. æ’ä»¶å°è£…ï¼šé€‚é… Vue3 ç”Ÿæ€ä¸è·¯ç”±\"></a>4. æ’ä»¶å°è£…ï¼šé€‚é… Vue3 ç”Ÿæ€ä¸è·¯ç”±</h3><p>å°†ä¸Šè¿°é€»è¾‘å°è£…ä¸º Vue æ’ä»¶ï¼Œæ”¯æŒé¦–å±é‡‡é›†ã€è·¯ç”±åˆ‡æ¢é‡‡é›†ã€å…¨å±€æ–¹æ³•æŒ‚è½½ï¼Œå®Œå…¨èå…¥ Vue é¡¹ç›®å¼€å‘æµç¨‹ã€‚</p>\n<figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> <span class=\"title class_\">WebVitalsPlugin</span>: <span class=\"title class_\">Plugin</span> = &#123;</span><br><span class=\"line\">  <span class=\"title function_\">install</span>(<span class=\"params\">app: App, options: WebVitalsPluginOptions</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// åˆå¹¶é»˜è®¤é…ç½®</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> finalOptions = &#123;</span><br><span class=\"line\">      <span class=\"attr\">reportUrl</span>: <span class=\"string\">&quot;/api/v1/monitor/web-vitals&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">delay</span>: <span class=\"number\">100</span>,</span><br><span class=\"line\">      <span class=\"attr\">reportFinalOnly</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">      ...options,</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// é¡µé¢ä¸Šä¸‹æ–‡ï¼šå­˜å‚¨å½“å‰é¡µé¢è·¯å¾„å’Œåç§°ï¼Œæ”¯æŒè·¯ç”±åˆ‡æ¢æ›´æ–°</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> currentPage = &#123;</span><br><span class=\"line\">      <span class=\"attr\">path</span>: <span class=\"keyword\">typeof</span> <span class=\"variable language_\">window</span> !== <span class=\"string\">&quot;undefined&quot;</span> ? <span class=\"variable language_\">window</span>.<span class=\"property\">location</span>.<span class=\"property\">pathname</span> : <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">name</span>: <span class=\"string\">&quot;FirstLoad&quot;</span>,</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 1. é¦–å±é‡‡é›†ï¼šDOMåŠ è½½å®Œæˆååˆå§‹åŒ–</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"title function_\">initFirstLoad</span> = (<span class=\"params\"></span>) =&gt; <span class=\"title function_\">initVitalsCollection</span>(finalOptions);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">readyState</span> === <span class=\"string\">&quot;complete&quot;</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">initFirstLoad</span>();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">window</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&quot;load&quot;</span>, initFirstLoad);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 2. è·¯ç”±åˆ‡æ¢é‡‡é›†ï¼šæ›´æ–°ä¸Šä¸‹æ–‡+é‡ç½®ç¼“å­˜+é‡æ–°é‡‡é›†</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (finalOptions.<span class=\"property\">router</span>) &#123;</span><br><span class=\"line\">      finalOptions.<span class=\"property\">router</span>.<span class=\"title function_\">afterEach</span>(<span class=\"function\">(<span class=\"params\">to: RouteLocationNormalized</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// å»¶è¿Ÿæ‰§è¡Œï¼Œç¡®ä¿DOMæ›´æ–°å®Œæˆï¼ˆé¿å…é‡‡é›†åˆ°æ—§é¡µé¢æ•°æ®ï¼‰</span></span><br><span class=\"line\">        <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          currentPage.<span class=\"property\">path</span> = to.<span class=\"property\">path</span>;</span><br><span class=\"line\">          currentPage.<span class=\"property\">name</span> = (to.<span class=\"property\">name</span> <span class=\"keyword\">as</span> <span class=\"built_in\">string</span>) || <span class=\"string\">&quot;UnknownPage&quot;</span>;</span><br><span class=\"line\">          <span class=\"title function_\">resetReportedMetrics</span>(currentPage.<span class=\"property\">path</span>);</span><br><span class=\"line\">          <span class=\"title function_\">initVitalsCollection</span>(finalOptions);</span><br><span class=\"line\">        &#125;, finalOptions.<span class=\"property\">delay</span>);</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 3. æŒ‚è½½å…¨å±€æ–¹æ³•ï¼šæ”¯æŒç»„ä»¶å†…æ‰‹åŠ¨æ§åˆ¶</span></span><br><span class=\"line\">    app.<span class=\"property\">config</span>.<span class=\"property\">globalProperties</span>.<span class=\"property\">$webVitals</span> = &#123;</span><br><span class=\"line\">      <span class=\"comment\">// æ‰‹åŠ¨æ›´æ–°é¡µé¢ä¸Šä¸‹æ–‡å¹¶é‡æ–°é‡‡é›†</span></span><br><span class=\"line\">      <span class=\"attr\">init</span>: <span class=\"function\">(<span class=\"params\">pagePath: <span class=\"built_in\">string</span>, pageName: <span class=\"built_in\">string</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">        currentPage.<span class=\"property\">path</span> = pagePath;</span><br><span class=\"line\">        currentPage.<span class=\"property\">name</span> = pageName;</span><br><span class=\"line\">        <span class=\"title function_\">resetReportedMetrics</span>(pagePath);</span><br><span class=\"line\">        <span class=\"title function_\">initVitalsCollection</span>(finalOptions);</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"comment\">// æç¤ºï¼šweb-vitalsä¸æ”¯æŒæ‰‹åŠ¨é”€æ¯ç›‘å¬ï¼Œä»…åšæç¤º</span></span><br><span class=\"line\">      <span class=\"attr\">dispose</span>: <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">warn</span>(<span class=\"string\">&quot;Web Vitals ç›‘å¬æ— æ³•æ‰‹åŠ¨é”€æ¯ï¼ˆåº“é™åˆ¶ï¼‰ï¼Œä»…é‡ç½®ä¸Šä¸‹æ–‡ã€‚&quot;</span>);</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ‰©å±•Vueå…¨å±€ç±»å‹ï¼Œæ”¯æŒTSç±»å‹æç¤º</span></span><br><span class=\"line\"><span class=\"keyword\">declare</span> <span class=\"variable language_\">module</span> <span class=\"string\">&quot;vue&quot;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">interface</span> <span class=\"title class_\">ComponentCustomProperties</span> &#123;</span><br><span class=\"line\">    <span class=\"attr\">$webVitals</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">init</span>: <span class=\"function\">(<span class=\"params\">pagePath: <span class=\"built_in\">string</span>, pageName: <span class=\"built_in\">string</span></span>) =&gt;</span> <span class=\"built_in\">void</span>;</span><br><span class=\"line\">      <span class=\"attr\">dispose</span>: <span class=\"function\">() =&gt;</span> <span class=\"built_in\">void</span>;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ä¸‰ã€æ’ä»¶ä½¿ç”¨ï¼šå¿«é€Ÿæ¥å…¥-Vue-é¡¹ç›®\"><a href=\"#ä¸‰ã€æ’ä»¶ä½¿ç”¨ï¼šå¿«é€Ÿæ¥å…¥-Vue-é¡¹ç›®\" class=\"headerlink\" title=\"ä¸‰ã€æ’ä»¶ä½¿ç”¨ï¼šå¿«é€Ÿæ¥å…¥ Vue é¡¹ç›®\"></a>ä¸‰ã€æ’ä»¶ä½¿ç”¨ï¼šå¿«é€Ÿæ¥å…¥ Vue é¡¹ç›®</h2><p>å°è£…å®Œæˆåï¼Œåœ¨ Vue é¡¹ç›®ä¸­åªéœ€å‡ æ­¥å³å¯æ¥å…¥ï¼Œæ”¯æŒè‡ªå®šä¹‰é…ç½®æ»¡è¶³ä¸åŒåœºæ™¯éœ€æ±‚ã€‚</p>\n<h3 id=\"1-åŸºç¡€ä½¿ç”¨ï¼ˆå¸¦è·¯ç”±é€‚é…ï¼‰\"><a href=\"#1-åŸºç¡€ä½¿ç”¨ï¼ˆå¸¦è·¯ç”±é€‚é…ï¼‰\" class=\"headerlink\" title=\"1. åŸºç¡€ä½¿ç”¨ï¼ˆå¸¦è·¯ç”±é€‚é…ï¼‰\"></a>1. åŸºç¡€ä½¿ç”¨ï¼ˆå¸¦è·¯ç”±é€‚é…ï¼‰</h3><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// main.ts</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; createApp &#125; <span class=\"keyword\">from</span> <span class=\"string\">&quot;vue&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; createRouter, createWebHistory &#125; <span class=\"keyword\">from</span> <span class=\"string\">&quot;vue-router&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">App</span> <span class=\"keyword\">from</span> <span class=\"string\">&quot;./App.vue&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"title class_\">WebVitalsPlugin</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&quot;./plugins/web-vitals&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> routes <span class=\"keyword\">from</span> <span class=\"string\">&quot;./routes&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> router = <span class=\"title function_\">createRouter</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">history</span>: <span class=\"title function_\">createWebHistory</span>(),</span><br><span class=\"line\">  routes,</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> app = <span class=\"title function_\">createApp</span>(<span class=\"title class_\">App</span>);</span><br><span class=\"line\">app.<span class=\"title function_\">use</span>(router);</span><br><span class=\"line\"><span class=\"comment\">// æ¥å…¥æ€§èƒ½ä¸ŠæŠ¥æ’ä»¶</span></span><br><span class=\"line\">app.<span class=\"title function_\">use</span>(<span class=\"title class_\">WebVitalsPlugin</span>, &#123;</span><br><span class=\"line\">  <span class=\"attr\">projectName</span>: <span class=\"string\">&quot;vue-web-vitals-demo&quot;</span>,</span><br><span class=\"line\">  <span class=\"attr\">buildVersion</span>: <span class=\"string\">&quot;v1.0.0&quot;</span>,</span><br><span class=\"line\">  router, <span class=\"comment\">// ä¼ å…¥è·¯ç”±å®ä¾‹ï¼Œæ”¯æŒåˆ‡æ¢é‡‡é›†</span></span><br><span class=\"line\">  <span class=\"attr\">metrics</span>: [<span class=\"string\">&quot;CLS&quot;</span>, <span class=\"string\">&quot;LCP&quot;</span>, <span class=\"string\">&quot;INP&quot;</span>], <span class=\"comment\">// åªé‡‡é›†æ ¸å¿ƒä¸‰ä¸ªæŒ‡æ ‡</span></span><br><span class=\"line\">  <span class=\"attr\">getUserId</span>: <span class=\"function\">() =&gt;</span> <span class=\"variable language_\">localStorage</span>.<span class=\"title function_\">getItem</span>(<span class=\"string\">&quot;userId&quot;</span>) || <span class=\"literal\">null</span>, <span class=\"comment\">// è‡ªå®šä¹‰è·å–ç”¨æˆ·ID</span></span><br><span class=\"line\">  <span class=\"comment\">// å¯é€‰ï¼šè‡ªå®šä¹‰ä¸ŠæŠ¥é€»è¾‘ï¼ˆå¦‚å¯¹æ¥åŸ‹ç‚¹å¹³å°ï¼‰</span></span><br><span class=\"line\">  <span class=\"comment\">// customReporter: (data) =&gt; console.log(&#x27;è‡ªå®šä¹‰ä¸ŠæŠ¥&#x27;, data)</span></span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">app.<span class=\"title function_\">mount</span>(<span class=\"string\">&quot;#app&quot;</span>);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-ç»„ä»¶å†…æ‰‹åŠ¨æ§åˆ¶\"><a href=\"#2-ç»„ä»¶å†…æ‰‹åŠ¨æ§åˆ¶\" class=\"headerlink\" title=\"2. ç»„ä»¶å†…æ‰‹åŠ¨æ§åˆ¶\"></a>2. ç»„ä»¶å†…æ‰‹åŠ¨æ§åˆ¶</h3><p>è‹¥æŸäº›éè·¯ç”±åˆ‡æ¢åœºæ™¯ï¼ˆå¦‚å¼¹çª—å†…å†…å®¹åŠ è½½ï¼‰éœ€è¦é‡‡é›†ï¼Œå¯é€šè¿‡å…¨å±€æ–¹æ³•æ‰‹åŠ¨è§¦å‘ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class=\"line\">import &#123; getCurrentInstance &#125; from &quot;vue&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">const &#123; proxy &#125; = getCurrentInstance()!;</span><br><span class=\"line\"></span><br><span class=\"line\">// æ‰‹åŠ¨åˆå§‹åŒ–é‡‡é›†ï¼ˆå¦‚å¼¹çª—æ‰“å¼€åï¼‰</span><br><span class=\"line\">const handleOpenModal = () =&gt; &#123;</span><br><span class=\"line\">  proxy.$webVitals.init(&quot;/modal/detail&quot;, &quot;è¯¦æƒ…å¼¹çª—&quot;);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å››ã€å…³é”®æ³¨æ„äº‹é¡¹\"><a href=\"#å››ã€å…³é”®æ³¨æ„äº‹é¡¹\" class=\"headerlink\" title=\"å››ã€å…³é”®æ³¨æ„äº‹é¡¹\"></a>å››ã€å…³é”®æ³¨æ„äº‹é¡¹</h2><ul>\n<li><p><strong>å½’å› æ•°æ®ä½¿ç”¨</strong>ï¼šè‹¥éœ€è¦é‡‡é›†æŒ‡æ ‡å½’å› ï¼ˆå¦‚ LCP å¯¹åº”çš„å…ƒç´ ã€TTFB çš„ç½‘ç»œé˜¶æ®µï¼‰ï¼Œéœ€å®‰è£… <code>web-vitals</code> çš„ attribution ç‰ˆæœ¬ï¼š<code>npm install web-vitals@attribution</code>ã€‚</p>\n</li>\n<li><p><strong>é”™è¯¯éš”ç¦»</strong>ï¼šä¸ŠæŠ¥é€»è¾‘å¿…é¡»ç”¨ try&#x2F;catch åŒ…è£¹ï¼Œé¿å…ä¸ŠæŠ¥å¤±è´¥é˜»å¡é¡µé¢ä¸»æµç¨‹ã€‚</p>\n</li>\n<li><p><strong>å»¶è¿Ÿé‡‡é›†æ—¶æœº</strong>ï¼šè·¯ç”±åˆ‡æ¢åçš„ delay å»ºè®®è®¾ç½® 100-300msï¼Œç¡®ä¿ DOM æ›´æ–°å®Œæˆï¼Œé‡‡é›†åˆ°å½“å‰é¡µé¢çš„çœŸå®æŒ‡æ ‡ã€‚</p>\n</li>\n<li><p><strong>å»é‡é€»è¾‘è°ƒæ•´</strong>ï¼šè‹¥éœ€æ”¯æŒåŒä¸€é¡µé¢å¤šæ¬¡é‡‡é›†ï¼ˆå¦‚åˆ·æ–°ï¼‰ï¼Œå¯ä¿®æ”¹å»é‡ç¼“å­˜çš„ key è§„åˆ™ï¼Œä»…æŒ‰æŒ‡æ ‡ ID å»é‡ã€‚</p>\n</li>\n</ul>\n<h2 id=\"äº”ã€æ€»ç»“\"><a href=\"#äº”ã€æ€»ç»“\" class=\"headerlink\" title=\"äº”ã€æ€»ç»“\"></a>äº”ã€æ€»ç»“</h2><p>é€šè¿‡å°è£…è¿™ä¸ª Vue æ’ä»¶ï¼Œæˆ‘ä»¬å®ç°äº†â€œè‡ªåŠ¨é‡‡é›†+è·¯ç”±é€‚é…+çµæ´»é…ç½®+é”™è¯¯éš”ç¦»â€çš„æ€§èƒ½æŒ‡æ ‡ä¸ŠæŠ¥èƒ½åŠ›ï¼Œæ—¢èƒ½ç²¾å‡†ç›‘æ§ç”¨æˆ·ä½“éªŒï¼Œåˆèƒ½æ— ç¼èå…¥ Vue é¡¹ç›®ç”Ÿæ€ã€‚å®é™…åº”ç”¨ä¸­ï¼Œå¯æ ¹æ®åç«¯æ¥å£éœ€æ±‚è°ƒæ•´ä¸ŠæŠ¥æ•°æ®ç»“æ„ï¼Œæˆ–å¯¹æ¥åŸ‹ç‚¹å¹³å°ï¼ˆå¦‚ç™¾åº¦ç»Ÿè®¡ã€ç¥ç­–ï¼‰å®ç°æ›´å…¨é¢çš„æ€§èƒ½åˆ†æã€‚</p>\n<p>æ€§èƒ½ä¼˜åŒ–æ˜¯ä¸€ä¸ªæŒç»­è¿­ä»£çš„è¿‡ç¨‹ï¼Œå…ˆé€šè¿‡æŒ‡æ ‡é‡‡é›†å®šä½ç“¶é¢ˆï¼Œå†é’ˆå¯¹æ€§ä¼˜åŒ–ï¼Œæ‰èƒ½è®©ç”¨æˆ·ä½“éªŒä¸æ–­æå‡ï½</p>\n<p><a href=\"https://github.com/ShuHongXie/minilo/blob/master/packages/minitor/vital/index.ts\">æœ¬æ’ä»¶å‚è€ƒä»£ç ï¼šminilo é¡¹ç›®</a></p>\n","feature":true,"text":"åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œæ€§èƒ½ä½“éªŒç›´æ¥å½±å“ç”¨æˆ·ç•™å­˜â€”â€”åŠ è½½æ…¢ã€äº¤äº’å¡é¡¿ã€å¸ƒå±€è·³åŠ¨ï¼Œéƒ½å¯èƒ½è®©ç”¨æˆ·ç¬é—´ç¦»å¼€ã€‚è€Œ web-vitals ä½œä¸º Google æ¨å‡ºçš„æ ¸å¿ƒ Web æ€§...","permalink":"/post/åŸºäºweb-vitalså°è£…Vueæ€§èƒ½æŒ‡æ ‡ä¸ŠæŠ¥æ’ä»¶ï¼Œç›‘æ§å‰ç«¯ä½“éªŒè´¨é‡","photos":[],"count_time":{"symbolsCount":"11k","symbolsTime":"10 mins."},"categories":[],"tags":[{"name":"Web-vitals","slug":"Web-vitals","count":1,"path":"api/tags/Web-vitals.json"},{"name":"æ€§èƒ½ä¸ŠæŠ¥","slug":"æ€§èƒ½ä¸ŠæŠ¥","count":1,"path":"api/tags/æ€§èƒ½ä¸ŠæŠ¥.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%80%E3%80%81%E5%85%88%E6%90%9E%E6%87%82%EF%BC%9Aweb-vitals-%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8C%87%E6%A0%87\"><span class=\"toc-text\">ä¸€ã€å…ˆææ‡‚ï¼šweb-vitals çš„æ ¸å¿ƒæŒ‡æ ‡</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BA%8C%E3%80%81Vue3-%E6%8F%92%E4%BB%B6%E5%B0%81%E8%A3%85%EF%BC%9A%E4%BB%8E%E9%85%8D%E7%BD%AE%E5%88%B0%E5%AE%9E%E7%8E%B0\"><span class=\"toc-text\">äºŒã€Vue3 æ’ä»¶å°è£…ï¼šä»é…ç½®åˆ°å®ç°</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%E6%8E%A5%E5%8F%A3%EF%BC%9A%E8%A7%84%E8%8C%83%E9%85%8D%E7%BD%AE%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84\"><span class=\"toc-text\">1. å®šä¹‰ç±»å‹æ¥å£ï¼šè§„èŒƒé…ç½®ä¸æ•°æ®ç»“æ„</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0%EF%BC%9A%E8%A7%A3%E5%86%B3%E8%AE%BE%E5%A4%87%E6%A0%87%E8%AF%86%E3%80%81%E5%8E%BB%E9%87%8D%E4%B8%8E%E6%95%B0%E6%8D%AE%E6%9E%84%E9%80%A0\"><span class=\"toc-text\">2. å·¥å…·å‡½æ•°ï¼šè§£å†³è®¾å¤‡æ ‡è¯†ã€å»é‡ä¸æ•°æ®æ„é€ </span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%EF%BC%881%EF%BC%89%E8%AE%BE%E5%A4%87%E5%94%AF%E4%B8%80%E6%A0%87%E8%AF%86%EF%BC%9A%E6%8C%81%E4%B9%85%E5%8C%96%E5%AD%98%E5%82%A8\"><span class=\"toc-text\">ï¼ˆ1ï¼‰è®¾å¤‡å”¯ä¸€æ ‡è¯†ï¼šæŒä¹…åŒ–å­˜å‚¨</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%EF%BC%882%EF%BC%89%E5%8E%BB%E9%87%8D%E7%BC%93%E5%AD%98%EF%BC%9A%E9%81%BF%E5%85%8D%E5%90%8C%E4%B8%80%E6%8C%87%E6%A0%87%E9%87%8D%E5%A4%8D%E4%B8%8A%E6%8A%A5\"><span class=\"toc-text\">ï¼ˆ2ï¼‰å»é‡ç¼“å­˜ï¼šé¿å…åŒä¸€æŒ‡æ ‡é‡å¤ä¸ŠæŠ¥</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%EF%BC%883%EF%BC%89%E6%95%B0%E6%8D%AE%E6%9E%84%E9%80%A0%EF%BC%9A%E8%9E%8D%E5%90%88%E5%AE%98%E6%96%B9%E4%B8%8E%E4%B8%9A%E5%8A%A1%E5%AD%97%E6%AE%B5\"><span class=\"toc-text\">ï¼ˆ3ï¼‰æ•°æ®æ„é€ ï¼šèåˆå®˜æ–¹ä¸ä¸šåŠ¡å­—æ®µ</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3-%E6%A0%B8%E5%BF%83%E9%87%87%E9%9B%86%E9%80%BB%E8%BE%91%EF%BC%9A%E5%AF%B9%E6%8E%A5-web-vitals-API\"><span class=\"toc-text\">3. æ ¸å¿ƒé‡‡é›†é€»è¾‘ï¼šå¯¹æ¥ web-vitals API</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#4-%E6%8F%92%E4%BB%B6%E5%B0%81%E8%A3%85%EF%BC%9A%E9%80%82%E9%85%8D-Vue3-%E7%94%9F%E6%80%81%E4%B8%8E%E8%B7%AF%E7%94%B1\"><span class=\"toc-text\">4. æ’ä»¶å°è£…ï¼šé€‚é… Vue3 ç”Ÿæ€ä¸è·¯ç”±</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%89%E3%80%81%E6%8F%92%E4%BB%B6%E4%BD%BF%E7%94%A8%EF%BC%9A%E5%BF%AB%E9%80%9F%E6%8E%A5%E5%85%A5-Vue-%E9%A1%B9%E7%9B%AE\"><span class=\"toc-text\">ä¸‰ã€æ’ä»¶ä½¿ç”¨ï¼šå¿«é€Ÿæ¥å…¥ Vue é¡¹ç›®</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%EF%BC%88%E5%B8%A6%E8%B7%AF%E7%94%B1%E9%80%82%E9%85%8D%EF%BC%89\"><span class=\"toc-text\">1. åŸºç¡€ä½¿ç”¨ï¼ˆå¸¦è·¯ç”±é€‚é…ï¼‰</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-%E7%BB%84%E4%BB%B6%E5%86%85%E6%89%8B%E5%8A%A8%E6%8E%A7%E5%88%B6\"><span class=\"toc-text\">2. ç»„ä»¶å†…æ‰‹åŠ¨æ§åˆ¶</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%9B%9B%E3%80%81%E5%85%B3%E9%94%AE%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9\"><span class=\"toc-text\">å››ã€å…³é”®æ³¨æ„äº‹é¡¹</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BA%94%E3%80%81%E6%80%BB%E7%BB%93\"><span class=\"toc-text\">äº”ã€æ€»ç»“</span></a></li></ol>","author":{"name":"è°¢å°è°¢","slug":"blog-author","avatar":"https://blog-1300014307.cos.ap-guangzhou.myqcloud.com/logo24.png","link":"/","description":"Love Music, love life","socials":{"github":"https://github.com/ShuHongXie","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{},"next_post":{"title":"åŸºäºHSLè‰²å€¼å®ç°åå°ç®¡ç†ç³»ç»Ÿä¸»é¢˜è‰²åŠ¨æ€åˆ‡æ¢çš„åŸç†ä¸å®è·µ","uid":"b3c60852837dddf35463cfd55ac55075","slug":"åŸºäºHSLè‰²å€¼å®ç°åå°ç®¡ç†ç³»ç»Ÿä¸»é¢˜è‰²åŠ¨æ€åˆ‡æ¢çš„åŸç†ä¸å®è·µ","date":"2025-02-24T16:00:00.000Z","updated":"2026-01-29T03:14:46.682Z","comments":true,"path":"api/articles/åŸºäºHSLè‰²å€¼å®ç°åå°ç®¡ç†ç³»ç»Ÿä¸»é¢˜è‰²åŠ¨æ€åˆ‡æ¢çš„åŸç†ä¸å®è·µ.json","keywords":"è°¢å°è°¢çš„åšå®¢ï¼Œå‰ç«¯å¼€å‘ï¼ŒVueï¼ŒNode.js","cover":"https://blog-1300014307.cos.ap-guangzhou.myqcloud.com/blog/wechat_2026-01-29_111419_691.png","text":"ä¸€ã€HSL è‰²å€¼åŸç†ï¼šæ›´é€‚åˆä¸»é¢˜åˆ‡æ¢çš„è‰²å½©è¡¨ç¤ºæ³•1.1 ä»€ä¹ˆæ˜¯ HSL è‰²å€¼HSL æ˜¯ä¸€ç§ç‰¹åˆ«è´´åˆäººçœ¼è‰²å½©æ„ŸçŸ¥çš„è‰²å½©ç©ºé—´æ¨¡å‹ï¼Œç”¨ä¸‰ä¸ªç»´åº¦å°±èƒ½ç²¾å‡†å®šä¹‰é¢œè‰²ï¼Œå’±ä»¬é€...","permalink":"/post/åŸºäºHSLè‰²å€¼å®ç°åå°ç®¡ç†ç³»ç»Ÿä¸»é¢˜è‰²åŠ¨æ€åˆ‡æ¢çš„åŸç†ä¸å®è·µ","photos":[],"count_time":{"symbolsCount":"9.6k","symbolsTime":"9 mins."},"categories":[],"tags":[{"name":"HSLè‰²å€¼","slug":"HSLè‰²å€¼","count":1,"path":"api/tags/HSLè‰²å€¼.json"},{"name":"æ¢è‚¤åŠŸèƒ½","slug":"æ¢è‚¤åŠŸèƒ½","count":1,"path":"api/tags/æ¢è‚¤åŠŸèƒ½.json"}],"author":{"name":"è°¢å°è°¢","slug":"blog-author","avatar":"https://blog-1300014307.cos.ap-guangzhou.myqcloud.com/logo24.png","link":"/","description":"Love Music, love life","socials":{"github":"https://github.com/ShuHongXie","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}